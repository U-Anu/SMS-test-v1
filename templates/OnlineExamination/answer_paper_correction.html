{% extends 'base.html' %}
{% block head_block %}

{% endblock  %}

{% block body_block %}
{% load static %}

<style>
    .status-card {
        display: inline-block;
        background-color: #28a745; /* Green background */
        color: white; /* White text */
        padding: 8px 16px;
        border-radius: 8px; /* Rounded corners */
        font-size: 14px;
        font-weight: bold;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Slight shadow for card effect */
    }
</style>

<div class="container-fluid">
    <div class="row">
    <center>
       <div class="main-header">
        <div class="col-md-4">
          <h4>Answer Paper Correction</h4>
          </div>
       </div>
    </center>

    </div>
    <br>
  
    <div class="col-md-12">
        <div class="card" style="padding: 10px;">
        
          <hr>
          <form method="post" >
            {% csrf_token %}
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="class">Class</label>
                <select class="form-control" name="class" id="id_class">
                    <option value="" >---Select---</option>
                    {% for data in class_records %}
                    <option value="{{ data.id }}">{{data.Class}}</option>
                    {% endfor %}

                </select>
            </div>
            <div class="col-md-6 mb-3">
                <label for="section">Section</label>
                <select class="form-control" name="section" id="id_section">
                    <option value="">---Select---</option>
              
                </select>                
            </div>
          
      <div class="col-md-12 mb-3"><br>

           <button type="submit" class="btn btn-primary" style="float: right;">Submit</button>
           </div>
              </form>
            </div>
        </div>
    </div>
   


   {% if student_answers %}
   <div class="col-md-12">
    <div class="card" style="padding: 10px;border-top: 5px solid black;">
        <div class="main-header">
            <h4>Qusetion Paper List</h4>
         </div><hr>
        <div class="table-responsive">
        <table id="tableID" class="display"  >
            <thead>
                <tr>
                    <th>S.No</th>
                    <th>Question paper name</th>
                    <th>Total mark:</th>
                    <th>Pass mark:</th>
                    <th>Duration:</th>
                    <th>Student Name:</th>
                    <!-- <th>Status:</th> -->
                  
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for data in student_answers %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{{data.question_paper.question_paper_name}}</td>
                    
                    <td>{{data.question_paper.total_mark}}</td>
                    <td>{{data.question_paper.pass_mark}}</td>
                    <td>{{data.question_paper.duration}}</td>
                    <td><b>{{ data.student.first_name }}</b></td>
                    <!-- <td>
                        <span class="status-card">Complete</span>
                    </td> -->
              
                    <td>                                   
                    
                        <a href="{% url 'online_exam_assign' data.id %}" class="bozero">
                            <span data-toggle="tooltip" title="Enroll" style="color: black;">
                                <i class="fas fa-pencil-alt"></i> Correction
                            </span>
                        </a>
                       </td>
                </tr>
                {% endfor %}
              
            </tbody>
    
        </table>
        </div>
     </div>
</div>
    {% else %}
       <center> <h5>No Records Found </h5></center>
    {% endif %}
    </div>
   
 {% endblock %}
 {% block script_block %}
 
<script>
  $(document).ready(function () {
      $(document).on('change', '#id_class', function () {
          var class_id = $('#id_class').val();
          var url = "{% url 'section_js' %}";

          $.ajax({
              url: url,
              data: {
                  'class_id': class_id
              },
              success: function (data) {
                  $("#id_section").html(data);
                  let html_data = '<option value="">--------</option>';
                  data.forEach(function (section) {
                      html_data += `<option value="${section.id}">${section.section_name}</option>`
                  });
                  console.log(html_data);
                  $("#id_section").html(html_data);
              },
              error: function (data) {
                  console.log(data);
              }
          });
      });

  });

  $(document).ready(function () {
      $(document).on('change', '#id_section', function () {
          var section_id = $('#id_section').val();
          var class_id = $('#id_class').val();
          var url = "{% url 'student_report_js' %}";
          $.ajax({
              url: url,
              data: {
                  'class_id': class_id,
                  'section_id': section_id,
              },
              success: function (data) {
                  $("#id_category").html(data);
                  let html_data = '<option value="">--------</option>';
                  data.forEach(function (subject) {
                      html_data += `<option value="${subject.id}">${subject.category}</option>`
                  });
                  console.log(html_data);
                  $("#id_category").html(html_data);
              },
              error: function (data) {
                  console.log(data);
              }
          });
      });

  });


</script>
 {% endblock  %}